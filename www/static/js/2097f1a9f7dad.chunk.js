"use strict";(self.webpackChunkhexo_pro=self.webpackChunkhexo_pro||[]).push([[209],{6579:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(6540),o=n(2248),a=n.n(o),i=n(1923);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=e.initValue,n=e.handleChangeContent,o=e.handleUploadingImage;var c=l((0,r.useState)(void 0),2),f=c[0],s=c[1],m=l((0,r.useState)(!1),2),d=m[0],y=m[1],p=l((0,r.useState)(!1),2),h=p[0],g=p[1];return(0,r.useEffect)((function(){return o(d),function(){y(void 0)}}),[d]),(0,r.useEffect)((function(){var e=new(a())("vditor",{theme:"classic",height:"100%",width:"100%",toolbarConfig:{pin:!1},after:function(){e.setValue(t);var n=document.querySelector(".vditor-toolbar"),r=document.getElementById("vditor");n&&r&&(n.style.width="".concat(r.clientWidth,"px"));var o=document.querySelector("vditor-content"),a=document.querySelector(".editor-header");console.log("editorHeader",a),console.log("content",o),o&&n&&a&&(console.log("走到这里了"),o.style.cssText="margin-top: ".concat(n.clientHeight+a.clientHeight,"px !important;")),window.addEventListener("resize",(function(){n&&r&&(n.style.width="".concat(r.clientWidth,"px"),o&&(o.style.marginTop="".concat(n.clientHeight+a.clientHeight,"px !important;")))}))},focus:function(e){g(!0)},blur:function(e){g(!1)},upload:{multiple:!1,error:function(e){console.log("err",e)},validate:function(e){return console.log("validate",e),!0},format:function(e,t){return console.log("format",e),t},file:function(e){return console.log("file",e),null},handler:function(t){console.log(t);var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}(t);try{var o=function(){var t=n.value;y(!0);var r=new FileReader;r.onload=function(n){var r=t.name;(function(e,t){return new Promise((function(n,r){i.Ay.post("/hexopro/api/images/upload",{data:e,filename:t}).then((function(e){n(e.data)})).catch((function(e){r(e)}))}))})(n.target.result,r).then((function(t){console.log("update=> ",t),t.code=0;t.msg,t.src;return setTimeout((function(){var n=e.getValue(),r=e.getCursorPosition();console.log("cursorPosition",r),h?e.setValue(n+"\n![alt text](".concat(t.src,")")):e.insertValue("\n![alt text](".concat(t.src,")"))}),300),null})).catch((function(e){return console.error("Image upload failed: ",e),e})).finally((function(){y(!1)}))},r.readAsDataURL(t)};for(r.s();!(n=r.n()).done;)o()}catch(e){r.e(e)}finally{r.f()}return null}},input:function(t){n(e.getValue())},toolbar:[{name:"emoji"},{name:"headings"},{name:"bold"},{name:"italic"},{name:"strike"},{name:"line"},{name:"quote"},{name:"list"},{name:"ordered-list"},{name:"check"},{name:"outdent"},{name:"indent"},{name:"code"},{name:"inline-code"},{name:"inline-code"},{name:"insert-after"},{name:"insert-before"},{name:"undo"},{name:"redo"},{name:"upload"},{name:"link"},{name:"table"},{name:"edit-mode"},{name:"preview",className:"toolbar-right"},{name:"fullscreen",className:"toolbar-right"},{name:"outline",className:"toolbar-right"},{name:"export",className:"toolbar-right"}]});return function(){null==f||f.destroy(),s(void 0)}}),[t]),r.createElement("div",{id:"vditorWapper",style:{width:"100%",height:"100%",flex:1,backgroundColor:"blue",borderRadius:"0px"}},r.createElement("div",{style:{width:"100%",height:"100%"},id:"vditor",className:"vditor"}))}},5915:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(8602),o=n(3598),a=n(7152),i=n(6370),l=n(1198),u=n(6044),c=n(3532),f=n(6476),s=n(6540),m=n(6942),d=n.n(m);function y(e){var t=e.initTitle,n=e.isPage,m=e.isDraft,y=e.popTitle,p=e.popDes,h=e.className,g=void 0===h?"":h,b=e.handleChangeTitle,v=e.handleSettingClick,A=e.handleRemoveSource,S=e.handlePublish;return s.createElement(a.A,{style:{width:"100%",borderBottomColor:"black",borderBottom:"1px solid gray",backgroundColor:"white"},align:"middle",className:d()("editor-header",g)},s.createElement(i.A,{span:12},s.createElement("input",{style:{width:"100%",height:60,border:"none",outline:"none",boxSizing:"border-box",fontSize:28,fontWeight:500,marginLeft:10},value:t,onChange:function(e){b(e.target.value)}})),s.createElement(i.A,{span:2,offset:9,style:{alignItems:"center",justifyContent:"center",paddingLeft:50}},s.createElement(f.A,null,s.createElement(l.Ay,{type:"default",icon:s.createElement(r.A,null),onClick:function(e){return v(e)}}),m&&!n?s.createElement(l.Ay,{type:"primary",onClick:S},"发布博客"):s.createElement(l.Ay,{type:"default",onClick:S},"转为草稿"),s.createElement(u.A,{title:y,description:p,onConfirm:function(){c.Ay.info({content:"ok"}),A()},onCancel:function(){c.Ay.error({content:"cancel"})}},s.createElement(l.Ay,{type:"default",icon:s.createElement(o.A,null)})))))}},8377:(e,t,n)=>{n.r(t),n.d(t,{FrontMatterAdder:()=>g});var r=n(1196),o=n(7977),a=n(6914),i=n(2702),l=n(6789),u=n(1198),c=n(1575),f=n(6540);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var h=r.A.Group;function g(e){var t=e.visible,n=e.onClose,s=e.title,p=e.existFrontMatter,g=e.frontMatter,b=e.onChange,v=y((0,f.useState)(!1),2),A=v[0],S=v[1],w=y((0,f.useState)(""),2),E=w[0],O=w[1],j=y((0,f.useState)(""),2),C=j[0],P=j[1];(0,f.useEffect)((function(){S(t)}),[t]);var x=function(){var e=Object.keys(p);return f.createElement(h,{onChange:function(e){var t={};e.forEach((function(e){t[e]=x[e]?x[e]:null})),b(t)},value:Object.keys(g)},e.map((function(e,t){return f.createElement(r.A,{key:e,value:function(t){var n=t.checked;return f.createElement(o.A,{key:e,title:g[e]?g[e]:"unset"},f.createElement(a.A,{key:e,color:n?"purple":"",style:{marginBottom:5}},e))}})})))},k=function(){if(0!=E.trim().length){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},g);e[E]=C,b(e)}};return A&&f.createElement(c.A,{title:s,bordered:!0,hoverable:!0,style:{position:"absolute",top:"100%",zIndex:100,width:"600px"},extra:f.createElement("div",{style:{display:"flex",alignItems:"center"}},f.createElement(i.A,null,f.createElement(l.A,{style:{flex:1},placeholder:"frontMatter Key",value:E,onChange:function(e){return O(e.target.value)},onPressEnter:k}),f.createElement(l.A,{style:{flex:1},placeholder:"frontMatter value",value:C,onChange:function(e){return P(e.target.value)},onPressEnter:k}),f.createElement(u.Ay,{type:"default",onClick:function(){S(!1),n()}},"X")))},x())}},5209:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(1923),o=n(6540),a=n(7767),i=n(2543),l=n.n(i),u=n(819),c=n(6579),f=n(5915),s=n(6510);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const y=function(){var e=(0,a.Zp)(),t=(0,o.useRef)(null),n=(0,a.g)()._id,i=m((0,o.useState)({isDraft:!0,source:null}),2),d=(i[0],i[1]),y=m((0,o.useState)({tags:[],categories:[],frontMatter:{},source:""}),2),p=y[0],h=y[1],g=m((0,o.useState)([]),2),b=(g[0],g[1]),v=m((0,o.useState)(""),2),A=v[0],S=v[1],w=m((0,o.useState)(""),2),E=w[0],O=w[1],j=m((0,o.useState)(""),2),C=(j[0],j[1]),P=m((0,o.useState)({}),2),x=(P[0],P[1]),k=m((0,o.useState)(!1),2),M=k[0],I=k[1],T=(0,s.A)(),D=function(e){return new Promise((function(t,n){r.eu.get("/hexopro/api/pages/"+e).then((function(e){t(e.data)})).catch((function(e){n(e)}))}))},N=function(e,t){if("pageMeta"==e)return h(t),void b(Object.keys(t.frontMatter));if("page"==e){var n=t.raw.split("---"),r=""===n[0]?2:1,o=n.slice(r).join("---").trim();O(t.title),C(o),d(t);var a=t._content;S(a)}};return(0,o.useEffect)((function(){var e={page:D(n),pageMeta:new Promise((function(e,t){r.eu.get("/hexopro/api/pageMeta/"+n).then((function(t){e(t.data)})).catch((function(e){t(e)}))}))};Object.keys(e).forEach((function(t){Promise.resolve(e[t]).then((function(e){var n={};n[t]=e,x(n),N&&N(t,e)}))}))}),[]),(0,o.useEffect)((function(){var e=l().debounce((function(e){!function(e){new Promise((function(t,o){r.eu.post("/hexopro/api/pages/"+n,e).then((function(e){t(e.data)})).catch((function(e){o(e)}))}))}(e)}),1e3,{trailing:!0,loading:!0});t.current=e}),[]),o.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"blue",overflowY:"auto"}},o.createElement(f.default,{isPage:!0,isDraft:!1,handlePublish:function(){},initTitle:E,popTitle:T["editor.header.pop.title"],popDes:T["page.editor.header.pop.des"],handleChangeTitle:function(e){e!=E&&(O(e),t.current({title:e}))},handleSettingClick:function(e){return I(!0)},handleRemoveSource:function(){new Promise((function(e,t){r.eu.get("/hexopro/api/pages/"+n+"/remove").then((function(t){e(t.data)})).catch((function(e){t(e)}))}));e("/pages")}}),o.createElement("div",{style:{backgroundColor:"red",width:"100%",flex:1,padding:0,border:"none"}},o.createElement(c.A,{initValue:A,handleChangeContent:function(e){t.current({_content:e})},handleUploadingImage:function(e){console.log("handleUploadingImage",e)}})),o.createElement(u.PageSettings,{visible:M,setVisible:I,pageMeta:p,setPageMeta:h,handleChange:function(e){return new Promise((function(t,o){r.eu.post("/hexopro/api/pages/"+n,e).then((function(e){t(e.data)})).catch((function(e){o(e)}))}))}}))}},819:(e,t,n)=>{n.r(t),n.d(t,{PageSettings:()=>A});var r=n(6540),o=n(6945),a=n(3532),i=n(7152),l=n(6370),u=n(2702),c=n(7977),f=n(6914),s=n(1198),m=n(6789),d=n(8377);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function A(e){var t=e.visible,n=e.setVisible,y=e.pageMeta,p=e.setPageMeta,g=e.handleChange,v=b((0,r.useState)(!1),2),A=v[0],S=v[1],w=b((0,r.useState)([]),2),E=w[0],O=w[1];return r.createElement(o.A,{title:r.createElement("div",{style:{textAlign:"left"}},"文章属性"),visible:t,onCancel:function(){p(h(h({},y),{},{tags:[],categories:[],frontMatter:E})),n(!1)},onOk:function(){var e;e=y.source,/^([a-zA-Z0-9-_\/]+)\/([a-zA-Z0-9-_]+\.md)$/i.test(e)?(n(!1),g({frontMatter:y.frontMatter,source:y.source})):a.Ay.error("配置的页面路径非法请检查！")},afterOpenChange:function(){O(y.frontMatter)},style:{width:800}},r.createElement(i.A,{style:{marginTop:15,marginBottom:15}},r.createElement(l.A,null,r.createElement(u.A,{style:{width:"100",flexWrap:"wrap"}},Object.keys(y.frontMatter).map((function(e){return r.createElement(c.A,{key:e,title:y.frontMatter[e]?y.frontMatter[e]:"unset"},r.createElement(f.A,{closable:!0,onClose:function(){return function(e){var t={};Object.keys(y.frontMatter).forEach((function(n){n!==e&&(t[n]=y.frontMatter[n])}));var n=h(h({},y),{},{frontMatter:t});p(n)}(e)},key:e,color:"blue",style:{marginBottom:5}},e))})),r.createElement(s.Ay,{type:"dashed",onClick:function(){S(!A)}},"+自定义frontMatter")),r.createElement(d.FrontMatterAdder,{existFrontMatter:E,onClose:function(){S(!1)},visible:A,title:"Font-Matter",frontMatter:y.frontMatter,onChange:function(e){var t=h(h({},y),{},{frontMatter:e});p(t)}}))),r.createElement(i.A,{style:{marginTop:15,marginBottom:15}},r.createElement(l.A,null,r.createElement(m.A,{style:{width:350},allowClear:!0,placeholder:"请输入页面存放路径",value:y.source,onChange:function(e){var t=h(h({},y),{},{source:e});p(t)}}))))}}}]);
//# sourceMappingURL=2097f1a9f7dad.chunk.js.map